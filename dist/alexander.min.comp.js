var alexander={version:"1.0.1",author:"Mees Gelein"},AJAX_LOGGING=!1;alexander.editor={new:function(areaID){return editor=new nicEditor({buttonList:["bold","italic","underline","strikeThrough","subscript","superscript"]}),editor.panelInstance(areaID),editor},exitEditor:function(){index=window.location.href.indexOf("?"),window.location=window.location.href.substring(0,index)}};;alexander.util={getUrlVars:function(){var vars={};window.location.href.replace(/[?&]+([^=&]+)=([^&]*)/gi,function(m,key,value){vars[key]=value});return vars},ce:function(name){return document.createElement(name)}};;alexander.select={getRange:function(){return r=null,tmp=alexander.util.ce("span"),window.getSelection&&window.getSelection().getRangeAt?(r=window.getSelection().getRangeAt(0),tmp.appendChild(r.extractContents()),tmp.innerHTML):document.selection&&document.selection.createRange?(r=document.selection.createRange(),tmp.appendChild(r.extractContents()),tmp.innerHTML):null},clear:function(){window.getSelection?window.getSelection().removeAllRanges():document.selection&&document.selection.empty()},replaceWithHTML:function(html){var range,html;if(window.getSelection&&window.getSelection().getRangeAt){(range=window.getSelection().getRangeAt(0)).deleteContents();var div=document.createElement("div");div.innerHTML=html;for(var child,frag=document.createDocumentFragment();child=div.firstChild;)frag.appendChild(child);range.insertNode(frag)}else document.selection&&document.selection.createRange&&(range=document.selection.createRange()).pasteHTML(html)}};;alexander.event={registerDocumentListeners:function(){document.addEventListener("paste",function(e){console.log(e.target.id);var pastedText=void 0;return window.clipboardData&&window.clipboardData.getData?pastedText=window.clipboardData.getData("Text"):e.clipboardData&&e.clipboardData.getData&&(pastedText=e.clipboardData.getData("text/plain")),e.preventDefault(),e.target.value="",document.execCommand("insertHTML",!1,pastedText),!1}),document.onkeydown=function(e){if(188==e.keyCode){if(e.shiftKey)return document.execCommand("insertHTML",!1,"‹"),!1}else if(190==e.keyCode&&e.shiftKey)return document.execCommand("insertHTML",!1,"›"),!1}}};;alexander.account={changePass:function(){var p=$("#pass");p.children().remove();p.append("<form class='form-horizontal' action='index.php' method='post'><input id='newPass' type='password' name='password' placeholder='New Password' class='form-control passField'><input type='password' name='passwordCheck' placeholder='New Password (Repeat)' class='form-control passField'><input type='password' name='passwordOld' placeholder='Old Password' class='form-control passField'><input type='submit' class='btn btn-primary' value='Change Password'></form>"),$("#newPass").focus()}};;alexander.ajax={req:function(method,ajaxData,callbackFn){var ajaxObject={ajaxMethod:method,data:ajaxData};AJAX_LOGGING&&(console.log("AJAX_REQ_START: method="+method),console.log(ajaxData),console.log("AJAX_REQ_END")),$.ajax({type:"POST",url:"ajax.php",data:ajaxObject,success:function(result){AJAX_LOGGING&&(console.log("AJAX_RESP_START"),console.log(result),console.log("AJAX_RESP_END")),callbackFn(result)}})}};;!function(_a){function updateTextOverview(){var query=$("#textFilter").val().trim();0!=(query=query.toLowerCase()).length?$(".textlink").each(function(i,item){-1!=$(item).text().toLowerCase().indexOf(query)?$(item).show():$(item).hide()}):$(".textlink").show()}function orderTextOverview(){var order=$("#textOrder").val().trim().toLowerCase(),items=$(".textlink").get(),orderClass=order.startsWith("title")?".loaderTitle":order.startsWith("name")?".loaderName":".loaderAuthor";items.sort(function(a,b){var textA=$(a).find(orderClass).text(),textB=$(b).find(orderClass).text();return textA<textB?1:textB<textA?-1:0}),-1==order.indexOf("desc")&&items.reverse(),$.each(items,function(i,item){$("#textOverview").append(item)})}alexander.text={load:function(){alexander.ajax.req("loadText",alexander.util.getUrlVars().txtID,function(responseText){nicEditors.findEditor("textEditor").setContent(responseText),activateHandles(),setTimeout(convertNote,1e3)})},save:function(andExit){var saveData={textContent:nicEditors.findEditor("textEditor").getContent().replace(/&nbsp;/g," "),authorName:$("#authorField").val().toLowerCase(),textName:$("#textNameField").val(),textTitle:$("#titleField").val(),locusF:$("#locusFromField").val(),locusT:$("#locusToField").val(),checkIn:andExit,textStatusSelect:$("#textStatusSelect").val()};alexander.ajax.req("saveTextContent",saveData,function(responseText){switch(responseText){case"OK":checkIn&&exitEditor();break;case"DB_ERR":alert("A database error occured. Saving has failed. Try again later.");break;case"AUTH_RES_ERR":alert("A result error has occured. This authorName is not yet registered. And you don't have the necessary privileges to register a new author");break;default:console.log("ERR:"+responseText)}})},create:function(){alexander.ajax.req("newText","",function(responseText){document.location=responseText})},loadOverview:function(){alexander.ajax.req("loadTextOverview","",function(responseText){$("#textOverview").html(responseText)}),this.renderOverview()},renderOverview:function(){updateTextOverview(),orderTextOverview()}}}();;$(document).ready(function(){alexander.event.registerDocumentListeners(),"function"==typeof init&&init()}),String.prototype.endsWith=function(suffix){return-1!==this.indexOf(suffix,this.length-suffix.length)},String.prototype.replaceAll=function(search,replacement){return this.replace(new RegExp(search,"g"),replacement)};