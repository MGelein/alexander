!function(_a){_a.markup={insert:function(){var range=alexander.select.getRange();alexander.select.replaceWithHtml("<span contenteditable='false' id='markupStart' class='handle redHandle'></span>"+range+"<span id='markupEnd' contenteditable='false' class='handle redHandle'></span>"),alexander.markup.requestID()},requestID:function(){alexander.ajax.req("requestMarkupID","",function(responseText){var objS=$("#markupStart").get(0),objE=$("#markupEnd").get(0);objS.id=responseText+"_start",objE.id=responseText+"_end",objS.innerHTML=objE.innerHTML=responseText,objS.title=objE.title=responseText,alexander.markup.registerListeners(),alexander.markup.load(responseText)})},registerListeners:function(){$(".handle").each(function(index,handle){var cHandle=$(handle);cHandle.unbind("mousedown").mousedown(function(event){alexander.markup.load(this.innerHTML)}),cHandle.unbind("mouseover").mouseover(function(event){alexander.markup.highlight(this.title,!0,!0)}),cHandle.unbind("mouseout").mouseout(function(event){alexander.markup.highlight(this.title,!1)})})},load:function(id){console.log(id),void 0==$("#holder_"+id).get(0)&&alexander.ajax.req("loadMarkup",id,function(responseText){alexander.editor.column.add(responseText),alexander.markup.registerListeners(),alexander.selection.clear(),console.log(responseText)})},move:function(id){var markupStart=$("#"+id+"_start"),markupEnd=$("#"+id+"_end"),startString=markupStart.wrap().parent().html(),endString=markupEnd.wrap().parent().html();markupStart.unwrap().remove(),markupEnd.unwrap().remove(),alexander.select.replaceWithHtml(startString+alexander.select.getRange()+endString),alexander.markup.registerListeners()},highlight:function(markupID,doHighlight,showWindow){if(void 0==markupID&&-1!=markupID){void 0==showWindow&&(showWindow=!1);var start=$("#"+markupID+"_start"),end=$("#"+markupID+"_end");$("#holder_"+markupID);doHighlight?(void 0!=check&&showWindow&&check.addClass("highlightMarkup"),start.addClass("handleSelected"),end.addClass("handleSelected")):(void 0!=check&&check.removeClass("highlightMarkup"),start.removeClass("handleSelected"),end.removeClass("handleSelected"))}},close:function(markupID){eval($("#close"+markupID+"Script").get(0).innerHTML)},save:function(markupID){var data={id:markupID,content:nicEditors.findEditor("annEditor_"+markupID).getContent()};alexander.ajax.req("saveMarkup",data,function(responseText){alexander.editor.column.remove(responseText)})}}}(alexander);